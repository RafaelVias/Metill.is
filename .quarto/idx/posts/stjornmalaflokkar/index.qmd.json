{"title":"Fjármál stjórnmálaflokkanna","markdown":{"yaml":{"title":"Fjármál stjórnmálaflokkanna","pagetitle":"Fjármál stjórnmálaflokkanna","subtitle":"Greining á ársreikningum stjórnmálaflokka úr gögnum Ríkisendurskoðunar","description":"A description\n","author":[{"name":"Brynjólfur Gauti Guðrúnar Jónsson","url":"https://twitter.com/bgautijonsson","affiliation":"Tölfræði, Raunvísindadeild Háskóla Íslands","affiliation-url":"https://www.hi.is/tolfraedi_0"}],"date":"2022/09/17","format":{"html":{"code-fold":true,"toc":true,"toc-depth":2,"toc-location":"right","toc-title":"Efnisyfirlit","page-layout":"full","smooth-scroll":true,"link-external-newwindow":true}},"execute":{"echo":false,"warning":false,"cache":false},"editor":"source","draft":false,"title-block-banner":true,"categories":["stjórnmál","efnahagur","ársreikningar","R","íslenska"],"href":"posts/stjornmalaflokkar/index.qmd","image":"Figures/eigidfe.png"},"headingText":"| include: false","containsRefs":false,"markdown":"\n\n\n```{r}\n\nlibrary(cowplot)\nlibrary(tidyverse)\nlibrary(scales)\nlibrary(ggthemes)\nlibrary(kableExtra)\nlibrary(gganimate)\nlibrary(lubridate)\nlibrary(geomtextpath)\nlibrary(ggtext)\nlibrary(readxl)\nlibrary(janitor)\nlibrary(plotly)\nlibrary(config)\nlibrary(DBI)\nlibrary(visitalaneysluverds)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(ggthemes)\nlibrary(cowplot)\nlibrary(scales)\nlibrary(visitalaneysluverds)\nlibrary(feather)\nlibrary(gganimate)\nlibrary(metill)\nlibrary(patchwork)\ntheme_set(theme_metill())\n\n```\n\n```{r}\nusr <- config::get(\"postgres_user\")\ncon <- dbConnect(RPostgres::Postgres(), \n                 dbname = usr$dbname, \n                 host = usr$host,\n                 port = usr$port, \n                 user = usr$username, \n                 password = usr$password)\n\nisk <- function(x, scale = 1e6, suffix = \" mkr\") number(x / scale, suffix = suffix, big.mark = \".\", decimal.mark = \",\")\nhlutf <- label_percent(accuracy = 0.1, big.mark = \".\", decimal.mark = \",\")\n```\n\n\n```{r}\nd <- tbl(con, \"arsreikningar_stjornmalaflokka\") |> \n    collect() |> \n    mutate_all(~ ifelse(is.na(.), 0, .)) |> \n    inner_join(\n        vnv() |> \n            group_by(ar = year(date)) |> \n            summarise(cpi = mean(cpi)) |> \n            mutate(cpi = cpi / cpi[ar == max(ar)]),\n        by = \"ar\"\n    ) |> \n    mutate(\n        flokkur = case_when(\n            flokkur == \"Flokkur Fólksins\" ~ \"Flokkur fólksins\",\n            flokkur == \"Framsóknarflokkurinn\" ~ \"Framsóknarflokkur\",\n            TRUE ~ flokkur\n        )\n    )\n\nxS <- \"#e41a1c\"\nxV <- \"#00441b\"\nxD <- \"#377eb8\"\nxP <- \"#984ea3\"\nxB <- \"#41ab5d\"\nxBF <- \"#cab2d6\"\nxC <- \"#ff7d14\"\nxM <- \"#08306b\"\nxFF <- \"#FBB829\"\nAnnad <- \"#e5d8bd\"\n\ncolours <- tibble(\n    flokkur = c(\n        \"Sjálfstæðisflokkur\",\n        \"Framsóknarflokkur\",\n        \"Samfylkingin\",\n        \"Vinstrihreyfingin - grænt framboð\",\n        \"Viðreisn\",\n        \"Píratar\",\n        \"Miðflokkurinn\",\n        \"Flokkur fólksins\"\n    ),\n    colour = c(\n        xD,\n        xB,\n        xS,\n        xV,\n        xC,\n        xP,\n        xM,\n        xFF\n    ),\n    merki = c(\n        \"xD\", \n        \"xB\",\n        \"xS\",\n        \"xV\",\n        \"xC\",\n        \"xP\",\n        \"xM\",\n        \"xF\"\n    )\n)\n\nd <- d |> \n    inner_join(\n        colours,\n        by = \"flokkur\"\n    )\n\nd <- d |> \n    left_join(\n        tbl(con, \"atkvaedi_stjornmalaflokka\") |> \n            filter(ar >= 2007) |> \n            collect() |> \n            mutate(ar = ifelse(ar == 2021, 2020, ar)),\n        by = c(\"flokkur\", \"ar\")\n    ) |> \n    left_join(\n        tbl(con, \"thingmenn_stjornmalaflokka\") |> \n            filter(ar >= 2007) |> \n            collect() |> \n            mutate(ar = ifelse(ar == 2021, 2020, ar)),\n        by = c(\"flokkur\", \"ar\")\n    )\n\n\n\n```\n\n\n```{r}\ndreifing_plot <- function(data, title) {\n    plot_dat <- data |> \n        select(ar, flokkur, value, colour) |> \n        group_by(ar) |> \n        mutate(p = value / sum(value)) |> \n        ungroup() |> \n        mutate(\n            flokkur = fct_reorder(flokkur, value, .fun = sum),\n            text = str_c(\n                \"<b>\", flokkur, \"</b>\", \"\\n\",\n                \"Ár: \", ar, \"\\n\",\n                \"Upphæð: \", isk(value), \"\\n\",\n                \"<b>% upphæða: \", hlutf(p), \"</b>\"\n            )\n        )\n    \n    \n    p <- plot_dat |> \n        ggplot(aes(ar, value, text = text)) +\n        geom_col(aes(fill = flokkur), position = \"fill\", colour = \"grey95\", width = 1) +\n        scale_x_continuous(breaks = 2007:2020) +\n        scale_y_continuous(labels = hlutf) +\n        scale_fill_manual(\n            values = c(\n                plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n            )\n        ) +\n        coord_cartesian(expand = FALSE) +\n        # theme_half_open() +\n        theme(legend.position = \"none\") +\n        labs(x = NULL, y = NULL, fill = NULL,\n             title = title)\n    \n    ggplotly(\n        p,\n        tooltip = \"text\"\n    ) |> \n        layout(\n            hoverlabel = list(align = \"left\")\n        )\n}\n\nmagn_plot <- function(data, title) {\n    plot_dat <- data |> \n        select(ar, flokkur, value, colour) |> \n        group_by(ar) |> \n        mutate(p = value / sum(value)) |> \n        ungroup() |> \n        mutate(\n            flokkur = fct_reorder(flokkur, value, .fun = sum),\n            text = str_c(\n                \"<b>\", flokkur, \"</b>\", \"\\n\",\n                \"Ár: \", ar, \"\\n\",\n                \"<b>Upphæð: \", isk(value), \"</b>\", \"\\n\",\n                \"% upphæða: \", hlutf(p)\n            )\n        )\n    \n    \n    p <- plot_dat |> \n        ggplot(aes(ar, value, text = text)) +\n        geom_col(aes(fill = flokkur), position = \"stack\", colour = \"grey95\", width = 1) +\n        scale_x_continuous(breaks = 2007:2020) +\n        scale_y_continuous(labels = isk) +\n        scale_fill_manual(\n            values = c(\n                plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n            )\n        ) +\n        coord_cartesian(expand = FALSE) +\n        # theme_half_open() +\n        theme(legend.position = \"none\") +\n        labs(x = NULL, y = NULL, fill = NULL,\n             title = title)\n    \n    ggplotly(\n        p,\n        tooltip = \"text\"\n    ) |> \n        layout(\n            hoverlabel = list(align = \"left\")\n        )\n}\n```\n\n\n\n# Tekjur stjórnmálaflokka\n\n## Opinber framlög\n\n### Ríkissjóður\n\n::: {.panel-tabset}\n\n#### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = (framlog_rikis + framlog_althingi) / cpi) |> \n    dreifing_plot(title = \"Dreifing framlaga ríkissjóðs á stjórnmálaflokka \")\n\n```\n\n#### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = (framlog_rikis + framlog_althingi) / cpi) |> \n    magn_plot(title = \"Framlög ríkissjóðs til stjórnmálaflokka \")\n```\n\n:::\n\n\n### Sveitarfélög\n\n::: {.panel-tabset}\n\n#### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_svf / cpi) |> \n    dreifing_plot(title = \"Dreifing framlaga sveitarfélaga til stjórnmálaflokka \")\n\n```\n\n#### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_svf / cpi) |> \n    magn_plot(title = \"Framlög sveitarfélaga til stjórnmálaflokka \")\n```\n\n:::\n\n### Opinber framlög alls\n\n::: {.panel-tabset}\n\n#### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_althingi + framlog_rikis + framlog_svf,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing framlaga hins opinbera til stjórnmálaflokka \")\n\n```\n\n#### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_althingi + framlog_rikis + framlog_svf,\n           value = value / cpi) |> \n    magn_plot(title = \"Framlög hins opinbera til stjórnmálaflokka \")\n```\n\n:::\n\n## Fyrirtæki og lögaðilar\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_fyrirtaekja,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing framlaga fyrirtækja/lögaðila til stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_fyrirtaekja,\n           value = value / cpi) |> \n    magn_plot(title = \"Framlög fyrirtækja/lögaðila til stjórnmálaflokka \")\n```\n\n### Magn (Án 2007)\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_fyrirtaekja,\n           value = value / cpi) |> \n    filter(ar > 2007) |> \n    magn_plot(title = \"Framlög fyrirtækja/lögaðila til stjórnmálaflokka (2008 - 2020)\")\n```\n\n:::\n\n## Einstaklingar\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_einstaklinga,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing framlaga einstaklinga til stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = framlog_einstaklinga,\n           value = value / cpi) |> \n    magn_plot(title = \"Framlög einstaklinga til stjórnmálaflokka \")\n```\n\n:::\n\n## Aðrar tekjur\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = adrar_tekjur,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing annarra tekna stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = adrar_tekjur,\n           value = value / cpi) |> \n    magn_plot(title = \"Aðrar tekjur stjórnmálaflokka \")\n```\n\n:::\n\n## Heildartekjur\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = tekjur,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing heildartekna stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = tekjur,\n           value = value / cpi) |> \n    magn_plot(title = \"Heildartekjur stjórnmálaflokka \")\n```\n\n:::\n\n\n# Kostnaður\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = gjold,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing kostnaðar stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = gjold,\n           value = value / cpi) |> \n    magn_plot(title = \"Kostnaður stjórnmálaflokka\")\n```\n\n:::\n\n# Eignir, skuldir og eigið fé\n\n\n## Eignir\n\n### Heildareignir\n\n::: {.panel-tabset}\n\n#### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing eigna stjórnmálaflokka \")\n\n```\n\n#### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir,\n           value = value / cpi) |> \n    magn_plot(title = \"Eignir stjórnmálaflokka \")\n```\n\n:::\n\n### Fastafjármunir\n\n::: {.panel-tabset}\n\n#### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir - veltufjarmunir,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing fastafjármuna stjórnmálaflokka \")\n\n```\n\n#### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir - veltufjarmunir,\n           value = value / cpi) |> \n    magn_plot(title = \"Fastafjármunir stjórnmálaflokka \")\n```\n\n:::\n\n## Skuldir\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = skuldir,\n           value = value / cpi) |> \n    dreifing_plot(title = \"Dreifing skulda stjórnmálaflokka \")\n\n```\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = skuldir,\n           value = value / cpi) |> \n    magn_plot(title = \"Skuldir stjórnmálaflokka \")\n```\n\n:::\n\n## Eigið fé\n\n::: {.panel-tabset}\n\n### Dreifing\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir - skuldir,\n           value = value / cpi) |> \n    mutate(value = value * (value >= 0)) |> \n    dreifing_plot(title = \"Dreifing eigin fjár stjórnmálaflokka \")\n\n```\n\n\n\n\n### Magn\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| column: page\n\nd |> \n    mutate(value = eignir - skuldir,\n           value = value / cpi) |> \n    magn_plot(title = \"Eigið fé stjórnmálaflokka \")\n```\n\n:::\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| include: false\n\nplot_dat <- d |> \n    mutate(value = (eignir - skuldir) / cpi) |> \n    select(ar, flokkur, value, colour) |> \n    group_by(ar) |> \n    mutate(p = value / sum(value)) |> \n    ungroup() |> \n    mutate(\n        flokkur = str_to_sentence(flokkur),\n        flokkur = fct_reorder(flokkur, value, .fun = mean)\n    )\n\n\np <- plot_dat |> \n    ggplot(aes(ar, value)) +\n    geom_col(aes(fill = flokkur), position = \"stack\", colour = \"grey95\", width = 1) +\n    scale_x_continuous(breaks = 2007:2020) +\n    scale_y_continuous(labels = isk) +\n    scale_fill_manual(\n        values = c(\n            plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n        )\n    ) +\n    coord_cartesian(expand = FALSE) +\n    guides(fill = guide_legend(reverse = T)) +\n    theme(legend.position = \"top\") +\n    labs(x = NULL, y = NULL, fill = NULL,\n         title = \"Eigið fé íslenskra stjórnmálaflokka\",\n         subtitle = \"Árið 2007 átti Sjálfstæðisflokkur 100% alls eigin fjár flokkanna en 2020 á hann 43,5%\",\n         caption = \"Mynd eftir @bggjonsson unnin úr ársreikningum stjórnmálaflokka frá Ríkisendurskoðun\")\n\nggsave(plot = p, filename = \"Figures/eigidfe.png\",\n       width = 8, height = 0.621 * 8, scale = 1.3, bg = \"white\")\n```\n\n\n\n\n\n```{r}\n#| fig-asp: 0.621\n#| fig-width: 10\n#| out-width: \"100%\"\n#| include: false\n#| eval: false\n#| column: page\n\n\n\n\nplot_dat <- d |> \n    mutate(\n        value = ifelse(\n            flokkur == \"Sjálfstæðisflokkur\", \n            leigutekjur,\n            gjold\n        ),\n        value = value / cpi\n    ) |> \n    filter(\n        flokkur %in% c(\"Sjálfstæðisflokkur\", \"Flokkur Fólksins\", \"Viðreisn\"),\n        ar >= 2015\n    ) |> \n    mutate(y = value,\n           # y = case_when(\n           #     flokkur == \"Flokkur Fólksins\" ~ y * 1.006,\n           #     flokkur == \"Viðreisn\" ~ y * 0.992,\n           #     flokkur == \"Sjálfstæðisflokkur\" ~ y * 0.994,\n           #     TRUE ~ y\n           # ),\n           label = ifelse(\n               flokkur == \"Sjálfstæðisflokkur\",\n               \"**Sjálfstæðisflokkur** (Leigutekjur)\",\n               str_c(flokkur, \" (Útgjöld)\")\n           )\n    )\n\np <- plot_dat |> \n    ggplot(aes(ar, value, colour = flokkur)) +\n    geom_line() +\n    geom_richtext(\n        data = plot_dat |> filter(ar == max(ar)),\n        aes(label = label, y = y),\n        hjust = 0,\n        nudge_x = 0.05,\n        fill = NA, label.color = NA\n    ) +\n    scale_x_continuous(limits = c(2014.8, 2021.9),\n                       expand = expansion(),\n                       breaks = c(2015:2020)) +\n    scale_y_continuous(labels = isk,\n                       breaks = pretty_breaks(4),\n                       limits = c(0, 80e6),\n                       expand = expansion()) +\n    scale_colour_manual(\n        values = c(xFF, xD, xC)\n    ) +\n    theme(legend.position = \"none\") +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Leigutekjur Sjálfstæðisflokks og útgjöld minni flokka\",\n         subtitle = \"Sjálfstæðisflokkur fengi nægar tekjur af útleigu fasteigna til að fjármagna Flokk floksins\")\n\nggsave(plot = p, filename = \"Figures/samanburdur.png\",\n       width = 8, height = 0.5 * 8, scale = 1.2, bg = \"white\")\n```\n\n\n\n```{r}\n#| fig-width: 10\n#| fig.asp: 1\n#| out-width: \"100%\"\n#| column: page\n#| include: false\n\nplot_dat <- d |> \n    mutate(value = (framlog_rikis + framlog_althingi + framlog_svf) / cpi) |> \n    select(ar, flokkur, value, colour) |> \n    group_by(ar) |> \n    mutate(p = value / sum(value),\n           flokkur = fct_reorder(flokkur, value, .fun = sum)) |> \n    ungroup() \n\n\np1 <- plot_dat |> \n    ggplot(aes(ar, value)) +\n    geom_col(aes(fill = flokkur), position = \"stack\", colour = \"grey95\", width = 1) +\n    scale_x_continuous(breaks = 2007:2020) +\n    scale_y_continuous(labels = isk) +\n    scale_fill_manual(\n        values = c(\n            plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n        )\n    ) +\n    coord_cartesian(expand = FALSE) +\n    theme(legend.position = \"none\",\n          axis.text.x = element_blank(),\n          # axis.line.x = element_blank(),\n          axis.ticks.x = element_blank()) +\n    labs(x = NULL, y = NULL, fill = NULL,\n         title = \"Samanburður á fjármálum stjórnmálaflokka\",\n         subtitle = \"Opinber framlög\")\n\nplot_dat <- d |> \n    mutate(value = framlog_fyrirtaekja / cpi) |> \n    select(ar, flokkur, value, colour) |> \n    group_by(ar) |> \n    mutate(p = value / sum(value),\n           flokkur = fct_reorder(flokkur, value, .fun = sum)) |> \n    ungroup() \n\n\np2 <- plot_dat |> \n    ggplot(aes(ar, value)) +\n    geom_col(aes(fill = flokkur), position = \"stack\", colour = \"grey95\", width = 1) +\n    scale_x_continuous(breaks = 2007:2020) +\n    scale_y_continuous(labels = isk) +\n    scale_fill_manual(\n        values = c(\n            plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n        )\n    ) +\n    coord_cartesian(expand = FALSE) +\n    theme(legend.position = \"none\",\n          axis.text.x = element_blank(),\n          # axis.line.x = element_blank(),\n          axis.ticks.x = element_blank(),\n          plot.margin = margin(t = 5, r = 5, b = 5, l = 12)) +\n    labs(x = NULL, y = NULL, fill = NULL,\n         title = NULL,\n         subtitle = \"Framlög fyrirtækja\")\n\nplot_dat <- d |> \n    mutate(value = framlog_einstaklinga / cpi) |> \n    select(ar, flokkur, value, colour) |> \n    group_by(ar) |> \n    mutate(p = value / sum(value),\n           flokkur = fct_reorder(flokkur, value, .fun = sum)) |> \n    ungroup() \n\n\np3 <- plot_dat |> \n    ggplot(aes(ar, value)) +\n    geom_col(aes(fill = flokkur), position = \"stack\", colour = \"grey95\", width = 1) +\n    scale_x_continuous(breaks = 2007:2020) +\n    scale_y_continuous(labels = isk) +\n    scale_fill_manual(\n        values = c(\n            plot_dat |> arrange(flokkur) |> distinct(colour) |> pull(colour)\n        )\n    ) +\n    coord_cartesian(expand = FALSE) +\n    theme(legend.position = \"none\",\n          plot.margin = margin(t = 5, r = 5, b = 5, l = 12)) +\n    labs(x = NULL, y = NULL, fill = NULL,\n         title = NULL,\n         subtitle = \"Framlög einstaklinga\")\n\np <- plot_grid(p1, p2, p3, ncol = 1, rel_heights = c(0.95, 0.95, 1))\n\np\n\nggsave(plot = p, filename = \"image.png\",\n       width = 8, height = 1 * 8, scale = 1.2, bg = \"white\")\n```\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":false,"freeze":true,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../style.css"],"toc":true,"toc-depth":2,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.175","editor":"source","theme":["paper","../../theme.scss"],"title-block-banner":true,"title":"Fjármál stjórnmálaflokkanna","pagetitle":"Fjármál stjórnmálaflokkanna","subtitle":"Greining á ársreikningum stjórnmálaflokka úr gögnum Ríkisendurskoðunar","description":"A description\n","author":[{"name":"Brynjólfur Gauti Guðrúnar Jónsson","url":"https://twitter.com/bgautijonsson","affiliation":"Tölfræði, Raunvísindadeild Háskóla Íslands","affiliation-url":"https://www.hi.is/tolfraedi_0"}],"date":"2022/09/17","draft":false,"categories":["stjórnmál","efnahagur","ársreikningar","R","íslenska"],"href":"posts/stjornmalaflokkar/index.qmd","image":"Figures/eigidfe.png","toc-location":"right","toc-title":"Efnisyfirlit","page-layout":"full","smooth-scroll":true},"extensions":{"book":{"multiFile":true}}}}}