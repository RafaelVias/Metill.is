[
  {
    "objectID": "posts/stjornmalaflokkar/index.html#opinber-framlög",
    "href": "posts/stjornmalaflokkar/index.html#opinber-framlög",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Opinber framlög",
    "text": "Opinber framlög\n\nRíkissjóður\n\nDreifingMagn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSveitarfélög\n\nDreifingMagn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOpinber framlög alls\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#fyrirtæki-og-lögaðilar",
    "href": "posts/stjornmalaflokkar/index.html#fyrirtæki-og-lögaðilar",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Fyrirtæki og lögaðilar",
    "text": "Fyrirtæki og lögaðilar\n\nDreifingMagnMagn (Án 2007)"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#einstaklingar",
    "href": "posts/stjornmalaflokkar/index.html#einstaklingar",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Einstaklingar",
    "text": "Einstaklingar\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#aðrar-tekjur",
    "href": "posts/stjornmalaflokkar/index.html#aðrar-tekjur",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Aðrar tekjur",
    "text": "Aðrar tekjur\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#heildartekjur",
    "href": "posts/stjornmalaflokkar/index.html#heildartekjur",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Heildartekjur",
    "text": "Heildartekjur\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#eignir",
    "href": "posts/stjornmalaflokkar/index.html#eignir",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Eignir",
    "text": "Eignir\n\nHeildareignir\n\nDreifingMagn\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFastafjármunir\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#skuldir",
    "href": "posts/stjornmalaflokkar/index.html#skuldir",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Skuldir",
    "text": "Skuldir\n\nDreifingMagn"
  },
  {
    "objectID": "posts/stjornmalaflokkar/index.html#eigið-fé",
    "href": "posts/stjornmalaflokkar/index.html#eigið-fé",
    "title": "Fjármál stjórnmálaflokkanna",
    "section": "Eigið fé",
    "text": "Eigið fé\n\nDreifingMagn"
  },
  {
    "objectID": "posts/kosningar/index.html",
    "href": "posts/kosningar/index.html",
    "title": "Alþingiskosningar",
    "section": "",
    "text": "Atkvæði og þingmenn\n\n\n\n\n\nMynd 1. Hvaða flokkar fá flesta þingmenn fyrir hvert atkvæði?\n\n\n\n\n\n\nPeningar\nRíkisendurskoðun birtir ársreikninga stjórnmálaflokkanna. Reyndar voru bara birtir útdrættir úr ársreikningunum fram til ársins 2019, en þar eru þó nægar upplýsingar til að framkvæma ýmsar greiningar. Til dæmis getum við skoðað útgjöld stjórnmálaflokka á hverju kjörtímabili og borið það saman við fjölda atkvæða í næstu kosningum.\n\n\n\n\n\n\nMynd 2. Meðaltal ársútgjalda frá síðustu kosningum deilt með fjölda atkvæða í yfirstandandi kosningum."
  },
  {
    "objectID": "posts/skattagogn/index.html",
    "href": "posts/skattagogn/index.html",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "",
    "text": "Code\nusr <- config::get(\"postgres_user\")\ncon <- dbConnect(RPostgres::Postgres(), \n                 dbname = usr$dbname, \n                 host = usr$host,\n                 port = usr$port, \n                 user = usr$username, \n                 password = usr$password)"
  },
  {
    "objectID": "posts/skattagogn/index.html#tekjutíund",
    "href": "posts/skattagogn/index.html#tekjutíund",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Tekjutíund",
    "text": "Tekjutíund\n\n\nCode\nplot_dat <- d |> \n    filter(tiundarbreyta == \"Heildartekjur\",\n           name %in% c(\"Tekjur alls\", \"Fjöldi í hóp\"),\n           ar == 2021) |> \n    collect() |> \n    pivot_wider(names_from = name, values_from = value) |> \n    janitor::clean_names()\n\nfjoldi <- number(sum(plot_dat$fjoldi_i_hop), big.mark = \".\", decimal.mark = \",\")\ntekjur <- number(sum(plot_dat$tekjur_alls), big.mark = \".\", decimal.mark = \",\")\ntekjur_a_mann <- number(sum(plot_dat$tekjur_alls) / sum(plot_dat$fjoldi_i_hop), acrucay = 0.1, big.mark = \".\", decimal.mark = \",\")\ntekjur_a_mann_a_manudi <- number(sum(plot_dat$tekjur_alls) / sum(plot_dat$fjoldi_i_hop) / 12, accuracy = 0.1, big.mark = \".\", decimal.mark = \",\")\n\n\nÞað er fátt jafn sexý og þegar einhver talar um tekjutíundir, en hvað þýðir það? Í gögnum Hagstofunnar um tekjur eru samtals 230.401 einstaklingar og þau fengu samtals tekjur upp á 2.182.908 milljónir króna, eða 9 milljónir króna á mann á ári (0,8 milljónir á mánuði).\nEn þessir einstaklingar höfðu ekki allir sömu tekjur, heldur er tekjum dreift ójafnt. Sum hafa hærri tekjur og aðrir lægri. Ímyndum að við tökum þessa 230.401 einstaklinga, röðum þeim í vaxandi röð eftir tekjum þeirra og skiptum svo í tíu jafnstóra hópa. Þá erum við komin með það sem kallast tekjutíundir! Í töflu I að neðan sjáum við hvernig heildartekjur skiptust í tekjutíundir árið 2021.\nHér ber að hafa í huga að allir einstaklingar sem náð hafa 16 ára aldri teljast með í þessum gögnum. Því þýða mánaðartekjur upp á 37 þúsund kr í lægstu tíundinni ekki að fjölskyldur þurfi að lifa á þeim tekjum, heldur eru þarna margir einstaklingar með engar eða mjög litlar tekjur.\n\n\nCode\nplot_dat |> \n    mutate(\n        p = tekjur_alls / sum(tekjur_alls),\n        p = percent(p, decimal.mark = \",\", big.mark = \".\"),\n        tekjur_a_mann = tekjur_alls / fjoldi_i_hop * 1e6 / 12,\n        tekjur_a_mann = number(\n            tekjur_a_mann, suffix = \" kr\", decimal.mark = \",\", big.mark = \".\"\n        ),\n        tekjur_a_mann = ifelse(\n            tiundarhluti == 1, \n            str_c(\n                tekjur_a_mann, \n                footnote_marker_alphabet(1, format = \"html\")\n            ),\n            tekjur_a_mann\n        ),\n        tekjur_alls = number(\n            tekjur_alls, suffix = \" mkr\", decimal.mark = \",\", big.mark = \".\"\n        )\n    ) |> \n    select(tiundarhluti, tekjur_a_mann, tekjur_alls, p) |> \n    kable(\n        format = \"html\",\n        col.names = c(\"Tekjutíund\", \"Tekjur á mann<br>(á mánuði)\", \"Tekjur alls\", \"Hlutfall allra tekna\"), \n        escape = FALSE, \n        align = c(\"c\", \"c\", \"c\", \"c\"),\n        caption = \"Tafla I. Skipting heildartekna á tekjutíundir árið 2021\"\n    ) |> \n    kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE) |> \n    footnote(alphabet = c(\"Einstaklingar á aldrinum 16-17 hafa oft engar eða litlar tekjur meirihluta árs.\"), fixed_small_size = T)\n\n\n\n\nTafla I. Skipting heildartekna á tekjutíundir árið 2021\n \n  \n    Tekjutíund \n    Tekjur á mann(á mánuði) \n    Tekjur alls \n    Hlutfall allra tekna \n  \n \n\n  \n    1 \n    37.203 kra \n    10.286 mkr \n    0,5% \n  \n  \n    2 \n    169.083 kr \n    46.748 mkr \n    2,1% \n  \n  \n    3 \n    303.747 kr \n    83.980 mkr \n    3,8% \n  \n  \n    4 \n    402.825 kr \n    111.373 mkr \n    5,1% \n  \n  \n    5 \n    490.488 kr \n    135.610 mkr \n    6,2% \n  \n  \n    6 \n    614.343 kr \n    169.861 mkr \n    7,8% \n  \n  \n    7 \n    780.465 kr \n    215.783 mkr \n    9,9% \n  \n  \n    8 \n    1.011.961 kr \n    279.787 mkr \n    12,8% \n  \n  \n    9 \n    1.370.797 kr \n    378.998 mkr \n    17,4% \n  \n  \n    10 \n    2.714.417 kr \n    750.482 mkr \n    34,4% \n  \n\n\na Einstaklingar á aldrinum 16-17 hafa oft engar eða litlar tekjur meirihluta árs.\n\n\n\n\nVið getum skipt öðrum breytum en tekjum í tíundir. Í mælaborðinu mínu um skattahögn Hagstofunnar er hægt að skoða ýmsar breytur eftir tíundum heildartekna, ráðstöfunartekna, eigna og annarra breytna!"
  },
  {
    "objectID": "posts/skattagogn/index.html#hversu-hátt-hlutfall-af-öllum-sköttum-borgar-hver-tekjuhópur",
    "href": "posts/skattagogn/index.html#hversu-hátt-hlutfall-af-öllum-sköttum-borgar-hver-tekjuhópur",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Hversu hátt hlutfall af öllum sköttum borgar hver tekjuhópur?",
    "text": "Hversu hátt hlutfall af öllum sköttum borgar hver tekjuhópur?\nÞað ætti ekki að koma á óvart að efri tekjutíundir borgi hærra hlutfall af öllum sköttum heldur en lægri tíundir. Fjármálaráðuneytið benti á það í tilkynningu þann 23. júní 2021 að efstu fimm tekjutíundirnar borgi 83% af öllum sköttum. Er þetta eftirtektarvert? Út frá töflunni okkar að ofan getum við séð að efstu fimm tíundirnar fá\n\\[\n34.4\\% + 17.4\\% + 12.8\\% + 9.9\\% + 7.8\\% = 82.3\\%\n\\]\naf öllum tekjum, og því ætti það alls ekki að koma okkur á óvart að þau borgi það hátt hlutfall af öllum sköttum. Þessi tala, 83%, þýðir því ekki að það sé vegið að þeim tekuhærri á óréttlátan hátt.\nEn hvað borgar hver tekjutíund mikið í skatta og hvernig ber því saman við heildartekjur þeirra? Á myndinni að neðan ber ég þetta tvennt saman. Hægt er að smella á Play til að sjá þróunina frá 1997 til 2021 eða velja ár til að skoða. Ef allir tekjuhópar borguðu jafnt hlutfall í skatta væru allir punktarnir á brotnu línunni.\n\n\nCode\nplot_dat <- d |>\n    filter(tiundarbreyta %in% \"Heildartekjur\",\n           name %in% c(\"Tekjur alls\", \n                       \"Ráðstöfunartekjur (Tekjur - Skattar)\",\n                       \"Fjöldi í hóp\")) |> \n    collect() |> \n    pivot_wider() |> \n    rename(fjoldi = \"Fjöldi í hóp\") |> \n    mutate(`Skattar alls` = `Tekjur alls` - `Ráðstöfunartekjur (Tekjur - Skattar)`) |> \n    select(-\"Ráðstöfunartekjur (Tekjur - Skattar)\") |> \n    pivot_longer(c(-ar, -tiundarbreyta, -tiundarhluti, -fjoldi)) |> \n    group_by(ar, name) |> \n    mutate(p = value / sum(value)) |> \n    ungroup()\n\n\nplot_dat <- plot_dat |> \n    select(-tiundarbreyta, -value) |> \n    pivot_wider(names_from = name, values_from = p) |> \n    janitor::clean_names() |> \n    rename(tekjur_hlutf = tekjur_alls, skattar_hlutf = skattar_alls) |> \n    inner_join(\n        plot_dat |> \n            select(-tiundarbreyta, -p) |> \n            pivot_wider(names_from = name, values_from = value) |> \n            janitor::clean_names(),\n        by = c(\"ar\", \"tiundarhluti\", \"fjoldi\")\n    ) |> \n    inner_join(\n        vnv() |> \n            group_by(ar = year(date)) |> \n            summarise(visitala = mean(cpi),\n                      .groups = \"drop\") |> \n            mutate(visitala = visitala / visitala[ar == max(ar)]),\n        by = \"ar\"\n    ) |> \n    mutate(tekjur_alls = tekjur_alls / visitala,\n           skattar_alls = skattar_alls / visitala,\n           skattar_hlutf_tekjum = skattar_alls / tekjur_alls) |> \n    mutate(text = str_c(\"<b>Tekjutíund: \", tiundarhluti, \"</b>\", \"\\n\",\n                        \"Ár: \", ar, \"\\n\",\n                        \"Tekjur (á mann á mánuði): \", number(tekjur_alls * 1e6 / (fjoldi * 12), suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                        \"% allra tekna: \", percent(tekjur_hlutf, accuracy = 0.1), \"\\n\",\n                        \"Skattar (á mann á mánuði): \", number(skattar_alls * 1e6 / (fjoldi * 12), suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                        \"% allra skatta: \", percent(skattar_hlutf, accuracy = 0.1), \"\\n\",\n                        \"Skattbyrði (% af tekjum): \", percent(skattar_hlutf_tekjum, accuracy = 0.1)))\n\n\n\np <- plot_dat |> \n    ggplot(aes(tekjur_hlutf, skattar_hlutf, \n               frame = ar, text = text)) +\n    geom_abline(intercept = 0, slope = 1, lty = 2) +\n    geom_point() +\n    scale_x_continuous(labels = label_percent(),\n                       expand = expansion(),\n                       limits = c(min(plot_dat$skattar_hlutf), 0.5),\n                       breaks = seq(0, 50, by = 10)/100) +\n    scale_y_continuous(labels = label_percent(),\n                       expand = expansion(),\n                       limits = c(min(plot_dat$skattar_hlutf), 0.5),\n                       breaks = seq(0, 50, by = 10)/100) +\n    theme_half_open() +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5)) +\n    labs(x = \"% af öllum tekjum\",\n         y = \"% af öllum sköttum\",\n         title = \"Hvað fær hver tekjutíund háa % af öllum tekjum og sköttum?\")\n\n\nggplotly(\n    p,\n    tooltip = \"text\"\n) |> \n    animation_opts(\n        transition = 500,\n        redraw = FALSE\n        \n    ) |> \n    animation_slider(currentvalue = list(prefix = \"Ár:\")) |> \n    layout(\n        hoverlabel = list(align = \"left\")\n    )"
  },
  {
    "objectID": "posts/skattagogn/index.html#skattbyrði",
    "href": "posts/skattagogn/index.html#skattbyrði",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Skattbyrði",
    "text": "Skattbyrði\nVið getum líka skoðað skattbyrði, eða hversu hátt hlutfall af tekjum sínum hver hópur borgar í skatta. Eins og að ofan er hægt að smella á Play til að sjá þróunina frá 1997 til 2021 eða velja ár sjálf til að skoða. Í sömu tilkynningu frá fjármálaráðuneytinu og ég nefndi að ofan var bent á að skattbyrði allra tekjutíunda nema þeirri efstu hefði lækkað frá 2019 til 2021. Það er rétt, en það er gott að hafa í huga að skattbyrði sömu tíunda hækkaði flestöll árin frá 1997 til 2019.\nNeðar í færslunni mun ég svo sýna hvernig skattbyrði hefur hækkað síðan 1997 hjá öllum tekjutíundum nema þeirri efstu.\n\n\nCode\nplot_dat <- plot_dat |> \n    mutate(\n        text = str_c(\"<b>Tekjutíund: \", tiundarhluti, \"</b>\", \"\\n\",\n                     \"Ár: \", ar, \"\\n\",\n                     \"Tekjur (á mann á mánuði): \", number(tekjur_alls * 1e6 / (fjoldi * 12), suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                     \"% allra tekna: \", percent(tekjur_hlutf, accuracy = 0.1), \"\\n\",\n                     \"Skattar (á mann á mánuði): \", number(skattar_alls * 1e6 / (fjoldi * 12), suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                     \"% allra skatta: \", percent(skattar_hlutf, accuracy = 0.1), \"\\n\",\n                     \"<b>Skattbyrði (% af tekjum): \", percent(skattar_hlutf_tekjum, accuracy = 0.1), \"</b>\")\n    )\np <- plot_dat |> \n    ggplot(aes(tiundarhluti, skattar_hlutf_tekjum, \n               frame = ar, text = text)) +\n    geom_line(aes(group = \"none\")) +\n    geom_point() +\n    scale_x_continuous(expand = expansion(add = 0.05),\n                       breaks = seq(0, 10, by = 1)) +\n    scale_y_continuous(labels = label_percent(),\n                       expand = expansion(add = 0.002),\n                       breaks = seq(0, 50, by = 10)/100) +\n    theme_half_open() +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5)) +\n    labs(x = \"Tekjutíund\",\n         y = \"Skattbyrðu (Skattar sem % af tekjum)\",\n         title = \"Skattbyrði eftir tekjutíund\")\n\n\nggplotly(\n    p,\n    tooltip = \"text\"\n) |> \n    animation_opts(\n        transition = 500,\n        redraw = FALSE\n        \n    ) |> \n    animation_slider(currentvalue = list(prefix = \"Ár:\")) |> \n    layout(\n        hoverlabel = list(align = \"left\")\n    )"
  },
  {
    "objectID": "posts/skattagogn/index.html#kaupmáttur-heildartekna",
    "href": "posts/skattagogn/index.html#kaupmáttur-heildartekna",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Kaupmáttur heildartekna",
    "text": "Kaupmáttur heildartekna\nKaupmáttur er einfaldlega hækkun á tekjum umfram verðbólgu (hækkun á verðlagi, mælt með vísitölu neysluverðs). Hér sjáum við hækkun kaupmáttar frá 1997 hjá meðaleinstakling úr hverru tekjutíund.\n\n\nCode\nplot_dat <- d |> \n    filter(tiundarbreyta == \"Heildartekjur\",\n           name %in% c(\"Tekjur alls\", \"Fjöldi í hóp\")) |> \n    collect() |> \n    pivot_wider() |> \n    rename(fjoldi = \"Fjöldi í hóp\") |> \n    pivot_longer(c(-ar, -tiundarbreyta, -tiundarhluti, -fjoldi)) |> \n    group_by(ar, name) |> \n    mutate(p = value / sum(value)) |> \n    ungroup() |> \n    select(-tiundarbreyta) |> \n    inner_join(\n        vnv() |> \n            group_by(ar = year(date)) |> \n            summarise(cpi = mean(cpi),\n                      .groups = \"drop\") |> \n            mutate(cpi = cpi / cpi[ar == max(ar)]),\n        by = \"ar\"\n    ) |> \n    mutate(\n        value = (value / fjoldi) / cpi,\n        index = value / value[ar == min(ar)],\n        text = str_c(\"<b>Tekjutíund: \", tiundarhluti, \"</b>\", \"\\n\",\n                     \"Ár: \", ar, \"\\n\",\n                     \"Heildartekjur (á mann á mánuði): \",\n                     number(value * 1e6 / 12, suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                     \"Breyting (síðan 1997): \", \n                     ifelse(index >= 1, \"+\", \"\"),\n                     percent(index - 1, accuracy = 0.01, big.mark = \".\", decimal.mark = \",\")\n        )\n    )\n\np <- plot_dat |> \n    ggplot(aes(ar, index, text = text)) +\n    geom_hline(yintercept = 1, lty = 2) +\n    geom_line(aes(group = tiundarhluti, col = tiundarhluti)) +\n    scale_x_continuous() +\n    scale_y_log10(\n        labels = function(x) percent(x - 1),\n        breaks = c(\n            1, 1.25, 1.5, 2, 3,\n            1/1.25, 1/1.5, 1/2, 1/3\n        )\n    ) +\n    scale_colour_distiller(type = \"div\", palette = \"RdYlBu\", direction = 1) +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          plot.title = element_text(size = 14)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Breyting á kaupmætti heildartekna frá 1997\")\n\nggplotly(\n    p,\n    tooltip = \"text\"\n) |> \n    layout(\n        hoverlabel = list(align = \"left\")\n    )"
  },
  {
    "objectID": "posts/skattagogn/index.html#kaupmáttur-ráðstöfunartekna",
    "href": "posts/skattagogn/index.html#kaupmáttur-ráðstöfunartekna",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Kaupmáttur ráðstöfunartekna",
    "text": "Kaupmáttur ráðstöfunartekna\nVið höfum frekar áhuga á kaupmætti ráðstöfunartekna (heildartekjur að frádegnum sköttum).\n\n\nCode\nplot_dat <- d |> \n    filter(tiundarbreyta == \"Ráðstöfunartekjur\",\n           name %in% c(\"Ráðstöfunartekjur (Tekjur - Skattar)\", \"Fjöldi í hóp\")) |> \n    collect() |> \n    pivot_wider() |> \n    rename(fjoldi = \"Fjöldi í hóp\") |> \n    pivot_longer(c(-ar, -tiundarbreyta, -tiundarhluti, -fjoldi)) |> \n    group_by(ar, name) |> \n    mutate(p = value / sum(value)) |> \n    ungroup() |> \n    select(-tiundarbreyta) |> \n    inner_join(\n        vnv() |> \n            group_by(ar = year(date)) |> \n            summarise(cpi = mean(cpi),\n                      .groups = \"drop\") |> \n            mutate(cpi = cpi / cpi[ar == max(ar)]),\n        by = \"ar\"\n    ) |> \n    mutate(\n        value = (value / fjoldi) / cpi,\n        index = value / value[ar == min(ar)],\n        text = str_c(\"<b>Tekjutíund: \", tiundarhluti, \"</b>\", \"\\n\",\n                     \"Ár: \", ar, \"\\n\",\n                     \"Ráðstöfunartekjur (á mann á mánuði): \", \n                     number(value * 1e6 / 12, suffix = \" kr\", big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                     \"Breyting (síðan 1997): \", \n                     ifelse(index >= 1, \"+\", \"\"),\n                     percent(index - 1, accuracy = 0.01, big.mark = \".\", decimal.mark = \",\")\n        )\n    )\n\np <- plot_dat |> \n    ggplot(aes(ar, index, text = text)) +\n    geom_hline(yintercept = 1, lty = 2) +\n    geom_line(aes(group = tiundarhluti, col = tiundarhluti)) +\n    scale_x_continuous() +\n    scale_y_log10(\n        labels = function(x) percent(x - 1),\n        breaks = c(\n            1, 1.25, 1.5, 2, 3,\n            1/1.25, 1/1.5, 1/2, 1/3\n        )\n    ) +\n    scale_colour_distiller(type = \"div\", palette = \"RdYlBu\", direction = 1) +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          plot.title = element_text(size = 14)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Breyting á kaupmætti ráðstöfunartekna frá 1997\")\n\nggplotly(\n    p,\n    tooltip = \"text\"\n) |> \n    layout(\n        hoverlabel = list(align = \"left\")\n    )"
  },
  {
    "objectID": "posts/skattagogn/index.html#skattbyrði-1",
    "href": "posts/skattagogn/index.html#skattbyrði-1",
    "title": "Tekjur, skattar og kaupmáttur",
    "section": "Skattbyrði",
    "text": "Skattbyrði\nÞað er líka áhugavert að skoða breytingu í skattbyrði milli 1997 og 2021. Hér þýðir jákvæð prósenta að skattbyrði hefur aukist, en neikvæð prósenta að hún sé minni. Við sjáum að skattbyrði hefur aukist hjá öllum tekjutíundunum nema þeirri efstu. Hér erum við að skoða skattbyrði hvers hóps í heild sinni, þannig að það getur alltaf verið að þetta passi ekki við hvern og einn einstakling, heldur á þetta við um meðaltal allra einstaklinganna.\n\n\nCode\nplot_dat <- d |>\n    filter(tiundarbreyta %in% \"Heildartekjur\",\n           name %in% c(\"Tekjur alls\", \n                       \"Ráðstöfunartekjur (Tekjur - Skattar)\",\n                       \"Fjöldi í hóp\")) |> \n    collect() |> \n    pivot_wider() |> \n    rename(fjoldi = \"Fjöldi í hóp\") |> \n    mutate(`Skattar alls` = `Tekjur alls` - `Ráðstöfunartekjur (Tekjur - Skattar)`) |> \n    select(-\"Ráðstöfunartekjur (Tekjur - Skattar)\") |> \n    janitor::clean_names() |> \n    mutate(\n        value = skattar_alls / tekjur_alls,\n        index = value - value[ar == min(ar)],\n        text = str_c(\"<b>Tekjutíund: \", tiundarhluti, \"</b>\", \"\\n\",\n                     \"Ár: \", ar, \"\\n\",\n                     \"Skattbyrði: \", \n                     percent(value, accuracy = 0.01, big.mark = \".\", decimal.mark = \",\"), \"\\n\",\n                     \"Breyting (síðan 1997): \", \n                     ifelse(index >= 0, \"+\", \"\"),\n                     percent(index, accuracy = 0.01, big.mark = \".\", decimal.mark = \",\", suffix = \"%-stig\")\n        )\n    )\n\np <- plot_dat |> \n    ggplot(aes(ar, index, text = text)) +\n    geom_hline(yintercept = 0, lty = 2) +\n    geom_line(aes(group = tiundarhluti, col = tiundarhluti)) +\n    scale_x_continuous() +\n    scale_y_continuous(\n        labels = label_percent(suffix = \"%-stig\")\n    ) +\n    scale_colour_distiller(type = \"div\", palette = \"RdYlBu\", direction = 1) +\n    theme_half_open() +\n    theme(legend.position = \"none\",\n          plot.title = element_text(size = 14)) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Breyting á skattbyrði miðað við 1997\")\n\nggplotly(\n    p,\n    tooltip = \"text\"\n) |> \n    layout(\n        hoverlabel = list(align = \"left\")\n    )"
  },
  {
    "objectID": "posts/vinnuafl/index.html",
    "href": "posts/vinnuafl/index.html",
    "title": "Vinnumarkaður",
    "section": "",
    "text": "Fjöldi starfandi\n\nAlmennur vinnumarkaðurOpinber vinnumarkaðurSaman\n\n\n\n\nCode\nplot_dat <-  d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    filter(year(dags) >= 2008)\n\np <- plot_dat |> \n    ggplot(aes(dags, Annad)) +  \n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$Annad), 1.2e5, 1.3e5, 1.4e5),\n                       limits = c(1e5, 1.5e5),\n                       labels = label_number()) +\n    scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\",   \n                 expand = expansion()) +  \n    labs(x = NULL,\n         y = NULL,\n         title = \"Fjöldi starfandi á almennum vinnumarkaði\") +\n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\nCode\nplot_dat <-  d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n)\n\np <- plot_dat |> \n    ggplot(aes(dags, Opinbert)) +  \n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$Opinbert), 5e4, 5.5e4, 6e4, 6.5e4),\n                       labels = label_number()) +\n    scale_x_date(date_breaks = \"year\", date_labels = \"%Y\", \n                 expand = expansion()) +  \n    labs(x = NULL,\n         y = NULL,\n         title = \"Fjöldi opinbers starfsfólks\") +\n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\nCode\nplot_dat <-  d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    mutate(tegund = fct_recode(as_factor(tegund),\n                               \"Opinber\" = \"Opinbert\",\n                               \"Almennur\" = \"Annad\"))\n\np <- plot_dat |> \n    ggplot(aes(dags, n)) +  \n    geom_line(aes(col = tegund)) +\n    geom_text(data = plot_dat |> filter(dags == max(dags)),\n              aes(label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$n[plot_dat$tegund == \"Opinber\"]), \n                                  range(plot_dat$n[plot_dat$tegund == \"Almennur\"]), 0),\n                       labels = label_number(),\n                       limits = c(0, 1.5e5),\n                       expand = expansion()) +\n    scale_x_date(date_breaks = \"year\", date_labels = \"%Y\",  \n                 expand = expansion(add = 31),\n                 limits = c(min(plot_dat$dags), max(plot_dat$dags) + 15)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Fjöldi starfandi á almennum og opinberum vinnumarkaði\") +\n    coord_cartesian(clip = \"off\") +\n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 60, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\n\nFjöldi miðað við fyrri ár\n\nAlmennurHlutfall Opinbert\n\n\n\n20172019\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    filter(year(dags) >= 2017) |>  \n    mutate(manudur = month(dags)) |>  \n    group_by(manudur) |>  \n    mutate(breyting = Annad - Annad[year(dags) == min(year(dags))]) |> \n    ungroup()\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    geom_vline(xintercept = ymd(c(\"2018-01-01\", \"2019-01-01\", \"2020-01-01\", \"2021-01-01\", \"2022-01-01\")), lty = 2, alpha = 0.3) +\n    geom_hline(yintercept = 0, lty = 2) +  \n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$breyting), -1e4, -5e3, 0, 5e3),\n                       labels = label_number(),\n                       limits = c(-1.8e4, 1e4)) +  \n    scale_x_date(date_breaks = \"3 months\", date_labels = \"%b/%y\",  \n                 guide = guide_axis(n.dodge = 2),  \n                 expand = expansion()) +  \n    labs(x = NULL, y = NULL,  \n         title = \"Fjöldi starfandi á almennum vinnumarkaði miðað við sama mánuð 2017\",\n         subtitle = \"Janúar 2022 er fyrsti mánuður þar sem fleiri unnu á almennum markaði en sama mánuð 2017\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    filter(year(dags) >= 2019) |>  \n    mutate(manudur = month(dags)) |>  \n    group_by(manudur) |>  \n    mutate(breyting = Annad - Annad[year(dags) == min(year(dags))]) |> \n    ungroup()\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    geom_vline(xintercept = ymd(c(\"2020-01-01\", \"2021-01-01\", \"2022-01-01\")), lty = 1, alpha = 0.1) +\n    geom_hline(yintercept = 0, lty = 2) +  \n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$breyting), -1.5e4, -1e4, -5e3, 0),\n                       labels = label_number(big.mark = \".\", decimal.mark = \",\"),\n                       limits = c(-1.8e4, NA)) +  \n    scale_x_date(date_breaks = \"3 months\", date_labels = \"%b/%y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion()) +  \n    labs(x = NULL, y = NULL,  \n         title = \"Fjöldi starfandi á almennum vinnumarkaði miðað við sama mánuð 2019\",\n         subtitle = \"Mars 2022 er annar mánuður frá 2020 þar sem fleiri unnu á almennum markaði en sama mánuð 2019\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\n\n\n20172019\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    filter(year(dags) >= 2017) |>  \n    mutate(manudur = month(dags),\n           hlutf = Opinbert / (Annad + Opinbert)) |> \n    ungroup() |> \n    group_by(manudur) |>  \n    mutate(breyting = hlutf - hlutf[year(dags) == min(year(dags))]) |> \n    ungroup()\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    geom_vline(xintercept = ymd(c(\"2018-01-01\", \"2019-01-01\", \"2020-01-01\", \"2021-01-01\", \"2022-01-01\")), lty = 2, alpha = 0.3) +\n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$breyting), 0.05, 0.04, 0.03, 0.02, 0.01),\n                       labels = label_percent(accuracy = 0.1)) +  \n    scale_x_date(date_breaks = \"3 months\", date_labels = \"%b\\n%y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion()) +  \n    labs(x = NULL, y = NULL,  \n         title = \"Munur á hlutfalli opinbers starfsfólks frá sama mánuði 2017\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    filter(year(dags) >= 2019) |>  \n    mutate(manudur = month(dags),\n           hlutf = Opinbert / (Annad + Opinbert)) |> \n    ungroup() |> \n    group_by(manudur) |>  \n    mutate(breyting = hlutf - hlutf[year(dags) == min(year(dags))]) |> \n    ungroup()\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    geom_vline(xintercept = ymd(c(\"2020-01-01\", \"2021-01-01\", \"2022-01-01\")), lty = 2, alpha = 0.3) +\n    geom_line() +  \n    geom_rangeframe() +  \n    scale_y_continuous(breaks = c(range(plot_dat$breyting), 0.05, 0.04, 0.03, 0.02, 0.01),\n                       labels = label_percent(accuracy = 0.1)) +  \n    scale_x_date(date_breaks = \"3 months\", date_labels = \"%b\\n%y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion()) +  \n    labs(x = NULL, y = NULL,  \n         title = \"Munur á hlutfalli opinbers starfsfólks frá sama mánuði 2019\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 20, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\n\n\n\n\n\n\n\n\nÁrstíðaleiðrétt hlutfall opinbers starfsfólks\n\nMyndAðferð\n\n\n\n\nCode\nmodel_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |>  \n    mutate(Heild = Opinbert + Annad) |> \n    filter(year(dags) >= 2008) |>  \n    mutate(manudur = month(dags),\n           timi = as.numeric(as.factor(dags)),\n           hlutf = Opinbert / (Annad + Opinbert)) |> \n    ungroup()\n\nm <- gam(Opinbert ~ s(manudur, bs = \"cc\") + s(timi, bs = \"ad\"), \n         data = model_dat, offset = log(Heild), family = nb(), method = \"REML\")\n\nplot_dat <- emmeans(m, ~ timi + manudur, at = list(timi = model_dat$timi,\n                                                   manudur = 1:12)) |> \n    tidy(type = \"response\") |> \n    group_by(timi) |> \n    mutate(wt = 1 / std.error,\n           wt = wt / sum(wt)) |> \n    summarise(response = sum(response * wt)) |> \n    inner_join(\n        model_dat,\n        by = \"timi\"\n    )\n\n\nopinbert_dat <- gam(Opinbert ~ s(manudur, bs = \"cc\") + s(timi, bs = \"ad\"), data = model_dat,\n                    family = nb(), method = \"REML\") |> \n    emmeans(~ timi, at = list(timi = unique(model_dat$timi))) |> \n    tidy() |> \n    inner_join(\n        model_dat |> \n            distinct(timi, dags)\n    ) |> \n    mutate(change = c(0, diff(estimate)),\n           perc_change = exp(change))\n\n\nalm_dat <- gam(Annad ~ s(manudur, bs = \"cc\") + s(timi, bs = \"ad\"), data = model_dat,\n               family = nb(), method = \"REML\") |> \n    emmeans(~ timi, at = list(timi = unique(model_dat$timi))) |> \n    tidy() |> \n    inner_join(\n        model_dat |> \n            distinct(timi, dags)\n    ) |> \n    mutate(change = c(0, diff(estimate)),\n           perc_change = exp(change))\n\n\nheild_dat <- gam(Heild ~ s(manudur, bs = \"cc\") + s(timi, bs = \"ad\"), data = model_dat,\n                 family = nb(), method = \"REML\") |> \n    emmeans(~ timi, at = list(timi = unique(model_dat$timi))) |> \n    tidy() |> \n    inner_join(\n        model_dat |> \n            distinct(timi, dags)\n    ) |> \n    mutate(change = c(0, diff(estimate)),\n           perc_change = exp(change))\n\nplot_dat2 <- heild_dat |> \n    mutate(tegund = \"Heild\") |> \n    bind_rows(\n        opinbert_dat |> \n            mutate(tegund = \"Opinber\")\n    )\n\n\ndates <- c(\"2009-08-01\", \"2018-01-01\", \"2021-01-01\")\n\np1 <- plot_dat |> \n    ggplot(aes(dags, hlutf)) +  \n    geom_vline(xintercept = ymd(dates), lty = 2, alpha = 0.5) +\n    geom_line(aes(y = hlutf), alpha = 0.1) +\n    geom_line(aes(y = response)) +  \n    geom_rangeframe(col = \"black\", size  = 1) +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), max(plot_dat$dags))) +\n    scale_y_continuous(breaks = c(range(plot_dat$hlutf),\n                                  0.3, 0.325),\n                       labels = label_percent(accuracy = 0.01),\n                       limits = c(0.25, 0.37)) +  \n    labs(x = NULL, y = NULL,  \n         title = \"Hlutfall opinbers starfsfólks af vinnumarkaði (2008 - 2022)\",\n         subtitle = \"Leiðrétt fyrir mánaðarlegum sveiflum. Raungögn teiknuð í gráu\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 60, b = 5, l = 5),\n          plot.title = element_text(face = \"bold\"))\n\np2 <- plot_dat2 |> \n    ggplot(aes(dags, perc_change)) +\n    geom_vline(xintercept = ymd(dates), lty = 2, alpha = 0.5) +\n    geom_hline(yintercept = 1, lty = 2) +\n    geom_line(aes(col = tegund)) +\n    geom_text(\n        data = plot_dat2 |> \n            filter(dags == max(dags)) |> \n            mutate(\n                y = case_when(\n                    tegund == \"Opinber\" ~ perc_change + 0.00015,\n                    tegund == \"Heild\" ~ perc_change - 0.00015,\n                )\n            ),\n        aes(y = y, label = tegund, col = tegund),\n        hjust = 0, nudge_x = 20\n    ) +\n    geom_rangeframe() +\n    scale_x_date(date_breaks = \"year\", date_labels = \"%Y\", \n                 expand = expansion()) +\n    scale_y_log10(labels = function(x) percent(x - 1),\n                  breaks = c(1, range(plot_dat2$perc_change), 1.005, 0.995)) +\n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    coord_cartesian(clip = \"off\") +\n    theme_tufte() +\n    theme(plot.margin = margin(t = 5, r = 60, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\")) +\n    labs(x = NULL,\n         y = NULL,\n         title = \"Mánaðarleg hlutfallsleg breyting fjölda starfsfólks (2008 - 2022)\",\n         subtitle = \"Er hækkun/lækkun hlutfalls að ofan vegna breytinga á opinberum eða almennum vinnumarkaði?\\nÞegar blá lína er ofar en sú rauða hækkar hlutfallið, og þegar hún er neðar lækkar hlutfallið\")\n\n\np <- plot_grid(p1, p2, ncol = 1)\n\np\n\n\n\n\n\nCode\nggsave(plot = p, filename = \"hlutf_opinbert.png\",\n       width = 8, height = 1 * 8, scale = 1.3, bg = \"white\")\n\n\n\n\n\nLeiðrétting fyrir árstíðarsveiflumTeljarinn og nefnarinn\n\n\nVið getum hugsað að þetta séu tvö ferli:\n\nLangtímaferli sem breytist án mjög ákveðins mynsturs\nÁrstíðabundnar sveiflur sem eru að mestu leyti svipaðar frá ári til árs\n\nNotum GAM (Generalized Additive Models) til að meta bæði ferlin saman. Splæsibrúunin (e. splines) metur ferlið í tveimur hlutum, línulegum og ólínulegum, og notar stika til að toga ólínulega hlutann í átt að línulegu ferli.\n\nÞar sem hæga þróunin getur verið að breytast mishratt á mismunandi árabilum notum við aðlögunarsplæsibrúun (e. adaptive smoother) þar sem ólínulegi stikinn fær að breytast með tíma. Í kóðanum er þetta táknað með s(timi, bs = \"ad\")\nÁrstíðarferlið hefur þær skorður að frávikið í upphafi og byrjun ársins á að stefna í sömu tölu, þ.e. \\(\\text{31. desember} \\approx \\text{1. janúar}\\). Pakkinn mgcv býður upp á slíka hringrásarsplæsara (e. cyclic smooths) [alveg í ruglinu með íslenskuna núna]. Í kóðanum er þetta táknað með s(manudur, bs = \"cc\")\n\nÞegar við erum komin með mat á þessi tvö ferli er lítið mál að heilda yfir árstíðarbundnu sveiflurnar. Við vigtum árstíðarbundna matið eftir nákvæmni matsins í hverjum mánuði (einum deilt með staðalvillu matsins) og reiknum svo meðaltal eftir því.\nAllt í allt metum við þá líkanið svona (einfölduð útgáfa af kóða):\ngam(Opinbert ~ s(manudur, bs = \"cc\") + s(timi, bs = \"ad\"), offset = log(Heild), family = nb())\nFjöldi opinbers starfsfólks er jákvæð fjöldatala svo fyrsta ágískunin er alltaf neikvæða tvíkostadreifingin. Við metum líkanið á lograkvarða, bæði því það er náttúrulega matið fyrir dreifinguna, en líka því við búumst við því að útkoman breytist hlutfallslega milli ára.\nHér fyrir neðan sjáum við svo matið á árstíðaráhrifum:\n\n\nCode\nplot_dat <- emmeans(m, ~ manudur, at = list(manudur = seq(1, 12, length.out = 100))) |> \n    tidy(type = \"response\") |> \n    mutate(response = exp(log(response) - mean(log(response))))\n\nplot_dat |> \n    ggplot(aes(manudur, response)) +\n    geom_hline(yintercept = 1, lty = 2) +\n    geom_line() +\n    geom_rangeframe() +\n    scale_x_continuous(breaks = 1:12,\n                       labels = c(\"Janúar\", \"Febrúar\", \"Mars\",\n                                  \"Apríl\", \"Maí\", \"Júní\",\n                                  \"Júli\", \"Ágúst\", \"September\",\n                                  \"Október\", \"Nóvember\", \"Desember\")) +\n    scale_y_continuous(labels = function(x) percent(x - 1),\n                       breaks = c(range(plot_dat$response), 1, 1.03),\n                       limits = c(0.92, 1.08)) +\n    theme_tufte() +\n    theme(plot.title = element_text(face = \"bold\")) +\n    labs(x = \"Mánuður\",\n         y = \"Árstíðarbundnar sveiflur\",\n         title = \"Árstíðarsveiflur í hlutfalli opinbers starfsfólks\")\n\n\n\n\n\n\n\nHlutall (p) opinbers starfsfólks (O) af heildarfjölda starfsfólks (H) má skrifa\n\\[\np = \\frac{O}{H},\n\\]\nÞar sem \\(H\\) inniheldur líka starfsfólk á almennum vinnumarkaði (A), s.s. \\(H = O + A\\).\nSkoðum hlutfallið á tveimur mismunandi tímapunktum, \\(p_1\\) og \\(p_2\\).\n\\[\n\\frac{p_2}{p_1} = \\frac{O_2/H_2}{O_1/H_1} = \\frac{O_2/O_1}{H_2/H_1}.\n\\]\nEf \\(p_2 > p_1\\) og \\(p_1 \\neq 0\\) gildir að \\(p_2/p_1 > 1\\) og því\n\\[\n\\begin{aligned}\n\\frac{O_2/O_1}{H_2/H_1} &> 1 \\\\\n\\rightarrow \\frac{O_2}{O_1} &> \\frac{H_2}{H_1},\n\\end{aligned}\n\\]\nþ.e. fjöldi opinbers starfsfólks hefur vaxið hlutfallslega hraðar en fjöldi starfsfólks alls.\nÞetta er kannski augljóst, en það er gott að hafa þetta í huga þegar hlutfallið hækkar og athuga hvort það sé vegna mikilla opinberra ráðninga eða fækkunar starfa á almennum vinnumarkaði.\nHér nota ég GAM til að smootha gögnin og nota svo árstíðaleiðrétt smooth gögn til að reikna stöðugar mánaðarlegar breytingar og teiknum þær svo.\n\n\n\n\n\n\n\n\nÁrlegar breytingar\n\nHrein breytingEftir bakgrunniHlutfallsleg breytingEftir bakgrunni\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |> \n    mutate(Heild = Annad + Opinbert) |> \n    pivot_longer(c(-dags), names_to = \"tegund\", values_to = \"n\") |> \n    filter(year(dags) >= 2008) |>  \n    mutate(manudur = month(dags)) |>\n    group_by(manudur, tegund) |>  \n    mutate(breyting = c(0, diff(n)),\n           uppsofnud_breyting = cumsum(breyting)) |> \n    ungroup() |> \n    filter(year(dags) > min(year(dags))) |> \n    mutate(tegund = fct_recode(tegund,\n                               \"Almennur\" = \"Annad\",\n                               \"Opinber\" = \"Opinbert\"))\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    # geom_vline(xintercept = ymd(seq.Date(from = min(plot_dat$dags),\n    #                                      to = ymd(\"2022-01-01\"),\n    #                                      by = \"year\")), lty = 2, alpha = 0.1) +\n    geom_hline(yintercept = 1, lty = 2, alpha = 0.6) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags)),\n              aes(label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe() +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2023-10-01\"))) +  \n    scale_y_continuous(labels = label_number(big.mark = \".\", decimal.mark = \",\"),\n                       breaks = c(range(plot_dat$breyting), -1.5e4, -1e4, -5e3, 0, 5e3, 1e4, 1.5e4)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    # coord_cartesian(ylim = c(0.84, 1.127)) +\n    labs(x = NULL, y = NULL,  \n         title = \"Hrein árleg breyting á fjölda starfsfólks á vinnumarkaði (2009 - 2022)\",\n         subtitle = \"Y-ás táknar mun á fjölda vinnandi frá sama mánuði á síðasta ári\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\nCode\nggsave(plot = p, filename = \"hrein_breyting_saman.png\",\n       width = 8, height = 0.5 * 8, scale = 1.3, bg = \"white\")\n\n\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\") |>  \n    count(dags, tegund, bakgrunnur, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |> \n    mutate(Heild = Annad + Opinbert) |> \n    pivot_longer(c(-dags, -bakgrunnur), names_to = \"tegund\", values_to = \"n\") |> \n    filter(year(dags) >= 2008) |>  \n    mutate(manudur = month(dags)) |>\n    group_by(manudur, tegund, bakgrunnur) |>  \n    mutate(breyting = c(0, diff(n)),\n           uppsofnud_breyting = cumsum(breyting)) |> \n    ungroup() |> \n    filter(year(dags) > min(year(dags))) |> \n    mutate(tegund = fct_recode(tegund,\n                               \"Almennur\" = \"Annad\",\n                               \"Opinber\" = \"Opinbert\"),\n           y = breyting,\n           y = case_when(tegund == \"Heild\" ~ y * 1.06,\n                         tegund == \"Almennur\" ~ y * 0.95,\n                         TRUE ~ y))\n\np1 <- plot_dat |> \n    filter(bakgrunnur == \"Íslenskur bakgrunnur\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(0, 0)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes =) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Íslenskur bakgrunnur\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe(sides = \"l\") +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%b/%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_continuous(labels = label_number(),\n                       breaks = c(0, range(plot_dat$breyting[plot_dat$bakgrunnur == \"Íslenskur bakgrunnur\"])),\n                       limits = range(plot_dat$breyting[plot_dat$bakgrunnur == \"Íslenskur bakgrunnur\"]), \n                       oob = oob_keep) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL,\n         title = \"Hrein árleg breyting á fjölda starfsfólks á vinnumarkaði (2009 - 2022)\",\n         subtitle = \"Y-ás táknar mun á fjölda vinnandi frá sama mánuði árið á undan\",) +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank())\n\np2 <- plot_dat |> \n    filter(bakgrunnur == \"Innflytjendur\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(0, 0)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes = FALSE) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Innflytjendur\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe(sides = \"l\") +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%b/%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_continuous(labels = label_number(),\n                       breaks = c(0, range(plot_dat$breyting[plot_dat$bakgrunnur == \"Innflytjendur\"])),\n                       limits = range(plot_dat$breyting[plot_dat$bakgrunnur == \"Innflytjendur\"]),\n                       oob = oob_keep) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL) +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 9),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank())\n\np3 <- plot_dat |> \n    filter(bakgrunnur == \"Alls\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(0, 0)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes = FALSE) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Alls\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe() +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_continuous(labels = label_number(),\n                       breaks = c(range(plot_dat$breyting), 0),\n                       limits = range(plot_dat$breyting),\n                       oob = oob_keep) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL,) +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA))\n\np <- plot_grid(p1, p2, p3, ncol = 1, rel_heights = c(1, 0.85, 1))\n\np\n\n\n\n\n\nCode\nggsave(plot = p, filename = \"hrein_breyting_saman_facet.png\",\n       width = 8, height = 0.7 * 8, scale = 1.2, bg = \"white\")\n\n\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\", bakgrunnur == \"Alls\") |>  \n    count(dags, tegund, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |> \n    mutate(Heild = Annad + Opinbert) |> \n    pivot_longer(c(-dags), names_to = \"tegund\", values_to = \"n\") |> \n    filter(year(dags) >= 2008) |>  \n    mutate(manudur = month(dags)) |>\n    group_by(manudur, tegund) |>  \n    mutate(breyting = c(1, exp(diff(log(n)))),\n           uppsofnud_breyting = exp(cumsum(log(breyting)))) |> \n    ungroup() |> \n    filter(year(dags) > min(year(dags))) |> \n    mutate(tegund = fct_recode(tegund,\n                               \"Almennur\" = \"Annad\",\n                               \"Opinber\" = \"Opinbert\"))\n\np <- plot_dat |> \n    ggplot(aes(dags, breyting)) +  \n    # geom_vline(xintercept = ymd(seq.Date(from = min(plot_dat$dags),\n    #                                      to = ymd(\"2022-01-01\"),\n    #                                      by = \"year\")), lty = 2, alpha = 0.1) +\n    geom_hline(yintercept = 1, lty = 2, alpha = 0.6) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags)),\n              aes(label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe() +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2023-10-01\"))) +  \n    scale_y_log10(breaks = c(range(plot_dat$breyting, na.rm = T), 0.9, 0.95, 1, 1.05, 1.1),\n                  labels = function(x) percent(x - 1)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    coord_cartesian(ylim = c(0.84, 1.127)) +\n    labs(x = NULL, y = NULL,  \n         title = \"Hlutfallsleg árleg breyting á fjölda starfsfólks á vinnumarkaði (2009 - 2022)\",\n         subtitle = \"Y-ás er á lograkvarða svo að -50% og +100% eru jafnlangt frá 0% breytingu\") +  \n    theme_tufte() +  \n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"))\n\np\n\n\n\n\n\nCode\nggsave(plot = p, filename = \"hlutf_breyting_saman.png\",\n       width = 8, height = 0.621 * 8, scale = 1.3, bg = \"white\")\n\n\n\n\n\n\nCode\nplot_dat <- d |>  \n    filter(rekstrarform != \"Alls starfandi\") |>  \n    count(dags, tegund, bakgrunnur, wt = starfandi) |>  \n    pivot_wider(names_from = tegund, values_from = n) |> \n    mutate(Heild = Annad + Opinbert) |> \n    pivot_longer(c(-dags, -bakgrunnur), names_to = \"tegund\", values_to = \"n\") |> \n    filter(year(dags) >= 2008) |>  \n    mutate(manudur = month(dags)) |>\n    group_by(manudur, tegund, bakgrunnur) |>  \n    mutate(breyting = c(1, exp(diff(log(n))))) |> \n    ungroup() |> \n    filter(year(dags) > min(year(dags))) |> \n    mutate(tegund = fct_recode(tegund,\n                               \"Almennur\" = \"Annad\",\n                               \"Opinber\" = \"Opinbert\"),\n           y = breyting,\n           y = case_when(tegund == \"Heild\" ~ y * (1 - 0.015 * (bakgrunnur == \"Innflytjendur\")),\n                         tegund == \"Almennur\" ~ y * 1,\n                         TRUE ~ y))\n\np1 <- plot_dat |> \n    filter(bakgrunnur == \"Íslenskur bakgrunnur\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(1, 1)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes = FALSE) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Íslenskur bakgrunnur\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe(sides = \"l\") +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%b/%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_log10(breaks = c(range(plot_dat$breyting[plot_dat$bakgrunnur == \"Íslenskur bakgrunnur\"], na.rm = T), 1),\n                  labels = function(x) percent(x - 1)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL,\n         title = \"Hlutfallsleg árleg breyting á fjölda starfsfólks á vinnumarkaði (2009 - 2022)\",\n         subtitle = \"Y-ás er á lograkvarða svo að -50% og +100% eru jafnlangt frá 0% breytingu\") +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank())\n\np2 <- plot_dat |> \n    filter(bakgrunnur == \"Innflytjendur\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(1, 1)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes = FALSE) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Innflytjendur\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe(sides = \"l\") +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%b/%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_log10(breaks = c(range(plot_dat$breyting[plot_dat$bakgrunnur == \"Innflytjendur\"], na.rm = T), 1),\n                  labels = function(x) percent(x - 1)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL) +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 9),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA),\n          axis.text.x = element_blank(),\n          axis.ticks.x = element_blank())\n\np3 <- plot_dat |> \n    filter(bakgrunnur == \"Alls\") |> \n    ggplot(aes(dags, breyting)) +  \n    geom_line(data = tibble(x = range(plot_dat$dags), y = c(1, 1)),\n              aes(x = x, y = y), lty = 2, alpha = 0.5, inherit.aes = FALSE) +\n    geom_line(aes(col = tegund)) +  \n    geom_text(data = plot_dat |> filter(dags == max(dags), bakgrunnur == \"Alls\"),\n              aes(y = y, label = tegund, col = tegund), hjust = 0, nudge_x = 10) +\n    geom_rangeframe(sides = \"lb\") +  \n    scale_x_date(breaks = seq.Date(from = min(plot_dat$dags), to = ymd(\"2022-01-01\"), by = \"year\"), \n                 date_labels = \"%Y\",  \n                 guide = guide_axis(n.dodge = 1),  \n                 expand = expansion(),\n                 limits = c(min(plot_dat$dags), ymd(\"2024-01-01\"))) +  \n    scale_y_log10(breaks = c(range(plot_dat$breyting[plot_dat$bakgrunnur == \"Alls\"], na.rm = T), 1),\n                  labels = function(x) percent(x - 1)) +  \n    scale_colour_brewer(type = \"qual\", palette = \"Set1\") +\n    facet_grid(bakgrunnur ~ .) +\n    labs(x = NULL, y = NULL,) +  \n    theme_tufte() +  \n    coord_cartesian(clip = \"off\") +\n    theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 5),\n          legend.position = \"none\",\n          plot.title = element_text(face = \"bold\"),\n          strip.background = element_rect(fill = \"grey95\", colour = NA))\n\np <- plot_grid(p1, p2, p3, ncol = 1, rel_heights = c(1, 0.85, 1))\n\np\n\n\n\n\n\nCode\nggsave(plot = p, filename = \"hrein_breyting_saman_facet.png\",\n       width = 8, height = 0.7 * 8, scale = 1.2, bg = \"white\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Metill",
    "section": "",
    "text": "Fjármál stjórnmálaflokkanna This is a subtitle\n      \n    \n    \n      \n    \n  \n  \n    \n      \n        Alþingiskosningar A subtitle\n      \n    \n    \n      \n    \n  \n  \n    \n      \n        Tekjur, skattar og kaupmáttur Greining á tekjuskattsgögnum Hagstofunnar\n      \n    \n    \n      \n    \n  \n\n\nNo matching items\n\n\nMælaborð\n\n\n  \n    \n      \n        Fjármál Sveitarfélaga \n      \n    \n    \n      \n    \n  \n  \n    \n      \n        Eignir, skuldir og skattar \n      \n    \n    \n      \n    \n  \n\n\nNo matching items"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Færslur",
    "section": "",
    "text": "This is a subtitle\n\n\nA description\n\n\n\n\n\n\nSep 17, 2022\n\n\nBrynjólfur Gauti Guðrúnar Jónsson\n\n\n\n\n\n\n  \n\n\n\n\n\nA subtitle\n\n\nA description of this stuff!\n\n\n\n\n\n\nSep 17, 2022\n\n\nBrynjólfur Gauti Guðrúnar Jónsson\n\n\n\n\n\n\n  \n\n\n\n\n\nGreining á tekjuskattsgögnum Hagstofunnar\n\n\nStundum les maður að skattakerfið ýti undir ójöfnuð, eða að það séu of háir skattar á þeim efnameiru. Hvort er það? Hér nota ég skattagögn Hagstofunnar til að skoða tekjur og skatta eftir tekjutíundum. Ég get ekki sagt hvort það sé sanngjarnt, en ég get sýnt hvernig það hefur breyst með tímanum.\n\n\n\n\n\n\nSep 11, 2022\n\n\nBrynjólfur Gauti Guðrúnar Jónsson\n\n\n\n\n\n\n  \n\n\n\n\n\nHver er fjöldi starfandi einstaklinga og hvernig skiptast þeir á vinnumarkaði?\n\n\nReglulega sjást fyrirsagnir þar sem talað er um að opinbert starfsfólk sé allt of margt og að hlutfall þess af heildarfjölda vinnandi fólks sé of hátt. Hér kryf ég reglulega nýjustu gögnin til að geta vitað hvort slíkar fullyrðingar séu teknar úr samhengi eða endurspegli raunveruleikann.\n\n\n\n\n\n\nSep 10, 2022\n\n\nBrynjólfur Gauti Guðrúnar Jónsson\n\n\n\n\n\n\nNo matching items"
  }
]